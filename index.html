<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Pipelined XSLT</title>

		<link rel="stylesheet" href="dist/reset.css">
		<link rel="stylesheet" href="dist/reveal.css">
		<link rel="stylesheet" href="dist/theme/black.css" id="theme">
		
		<!-- Theme used for syntax highlighted code -->
		<link rel="stylesheet" href="plugin/highlight/monokai.css" id="highlight-theme">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				
				<!-- START of Intro -->
				<section>
					
					<!--  data-background="img/notre-dame.jpg" data-background-size="100%" -->
					
					<section>
						
						<h1 style="">Pipelined XSLT</h1>
						
						<h3 style="">Balisage 2020</h3>
						<p style="font-size: smaller;">Ari Nordstr√∂m | ari.nordstrom@gmail.com</p>
						
						<img src="img/GG-Drainage-image-PVC-pipes-background.jpg" alt="Stacked pipes" width="500"/>
						
						<aside class="notes">
							
						</aside>
					</section>
					
					<section>
						<h3>Basics</h3>
						
						<!--<img src="img/watch-your-head.png" alt="Watch your head sigh-seeing bus sign" style="width: 47%; height: auto"/>-->
						
						<ol>
							<li>Step 1</li>
							<li>Step 2</li>
							<li>Step 3</li>
						</ol>
						
						<aside class="notes">
							<p>You need to change the order of the steps...</p>
						</aside>
					</section>
					
					<section>
						<h3>Basics</h3>
						
						<ol>
							<li>Step 1</li>
							<li>Step 3</li>
							<li class="fragment highlight-red">Step 4</li>
							<li>Step 2</li>
						</ol>
						
						<aside class="notes">
							<p>And add to them</p>
						</aside>
					</section>
					
					<section>
						<h3>Where I Come From</h3>
						
						<span>
							<img src="img/halsburys-laws-of-england.jpg" alt="Halsbury's Laws of England"/>
						</span>
						<!-- Use cases -->
						<!-- Lexis RTF to XML in batch -->
						<!-- Karnov SFS convert, compare and merge -->
						<!-- Excel to XML -->
						<!-- In other words, complex conversions in batch -->
						<aside class="notes">
							<p>Lexis: RTF to XML (Nic Gibson and XProc Tools)</p>
							<p>Karnov: SFS XML merge</p>
							<p>On-demand Excel to online XML feed</p>
							<p>Complex conversions in batch</p>
						</aside>
					</section>
					
					<section>
						<!-- Disclaimer and my background with pipelined XSLT -->
						<h3>Disclaimer</h3>
						
						<img src="img/submerged-pipeline-sign-1545047.jpg" alt="submerged pipeline" height="300"/>
						
						<aside class="notes">
							<p>Lexis - first organised XSLT pipelines</p>
							<p>Previously, hard-coded XProc, etc</p>
							
						</aside>
					</section>
					
				</section>
				
				<!-- END of Intro -->
				
					
				
				<!-- START of Mechanics -->
				
				<section>
					<section>
						<h3>Mechanics</h3>
						
						<img src="img/lost-places-2178884_1920.jpg" alt="lost places" height="400"/>
						
						<!-- Link to Nic's XProc Tools, explanation of when I first encountered them -->
						
						<aside class="notes">
							
						</aside>
					</section>
					
					<section>
						<!-- Manifest file -->
						<p>Manifests</p>
						
						<pre class="stretch">
                            <code class="xml" data-line-numbers="1-15|5,9-10" data-trim data-noescape>&lt;manifest xml:base=".">
    
    &lt;group description="Just a demo" xml:base="../xslt/">
        &lt;item href="step1.xsl" description="To element one">
            &lt;meta name="param1" value="value1"/>
        &lt;/item>
        &lt;item href="step2.xsl" description="To element two"/>
        &lt;item href="step3.xsl" description="To element three">
            &lt;meta name="param3A" value="value3A"/>
            &lt;meta name="param3B" value="value3B"/>
        &lt;/item>
        &lt;item href="step4.xsl" description="To element four"/>
    &lt;/group>
    
&lt;/manifest></code>
						</pre>
						
						<aside class="notes">
							<p>Each item is a step</p>
							<p>Steps in document order</p>
							<p>Note the meta elements injecting parameters</p>
							<p>Which brings us to development</p>
						</aside>
						
					</section>
					
				</section>
				
				<!-- END of Mechanics -->
				
				
				
				<!-- START of Developing -->
				
				<section>
					<section>
						<h3>Developing</h3>
						
						<!-- General about dev, way of thinking -->
						<img src="img/watch-your-step-1457443.jpg" alt="Watch your step" height="300"/>
						
						<aside class="notes">
							<p><strong>Each step does one thing</strong></p>
							<p>(so a lot of steps result)</p>
						</aside>
					</section>
					
					<section>
						<!-- Step 1 -->
						<pre class="stretch">
                            <code class="xml" data-line-numbers="|10-15|17-22" data-trim data-noescape>&lt;xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    version="2.0">
    
    &lt;xsl:param name="param1"/>
    
    &lt;xsl:template match="/">
        &lt;xsl:apply-templates select="node()" mode="STEP-1"/>
    &lt;/xsl:template>
    
    &lt;xsl:template match="*" mode="STEP-1" priority="1">
        &lt;one one="{$param1}">
            &lt;xsl:copy-of select="@*"/>
            &lt;xsl:apply-templates select="node()" mode="STEP-1"/>
        &lt;/one>
    &lt;/xsl:template>
    
    &lt;xsl:template match="node()" mode="STEP-1">
        &lt;xsl:copy>
            &lt;xsl:copy-of select="@*"/>
            &lt;xsl:apply-templates select="node()" mode="STEP-1"/>
        &lt;/xsl:copy>
    &lt;/xsl:template>
    
&lt;/xsl:stylesheet></code>
						</pre>
						
						<aside class="notes">
							<p>This does one thing (converting every element to element 'one')</p>
							<p>And there's an ID transform</p>
						</aside>
					</section>
					
					<section>
						<!-- Step 2 -->
						<pre class="stretch">
                            <code class="xml" data-line-numbers="8-13" data-trim data-noescape>&lt;xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    version="2.0">
    
    &lt;xsl:template match="/">
        &lt;xsl:apply-templates select="node()" mode="STEP-2"/>
    &lt;/xsl:template>
    
    &lt;xsl:template match="one" mode="STEP-2">
        &lt;two>
            &lt;xsl:copy-of select="@*"/>
            &lt;xsl:apply-templates select="node()" mode="STEP-2"/>
        &lt;/two>
    &lt;/xsl:template>
    
    &lt;-- ... (identity transform) -->
    
&lt;/xsl:stylesheet></code>
						</pre>
						
						<aside class="notes">
							<p>Step 2 does one more thing</p>
							<p>Note the dependence on step 1</p>
							<p>And I've left out the ID transfomr</p>
						</aside>
					</section>
					
					<section>
						<!-- Debug -->
						
						<pre class="stretch">
                            <code style="font-size: smaller;" class="text" data-line-numbers="|4|5-22|3|2" data-trim data-noescape>ari@toddao:~/poc/tmp/debug/Activate_Learning.xml$ ls -lh
total 106M
-rw-r--r-- 1 ari ari 3,5M mar  5 16:16 0-Activate_Learning.xml
-rw-r--r-- 1 ari ari 3,5M mar  5 16:16 1-XLSX-UTIL_remove-empty.xsl.xml
-rw-r--r-- 1 ari ari 6,4M mar  5 16:16 2-XLSX-UTIL_normalisation.xsl.xml
-rw-r--r-- 1 ari ari 6,4M mar  5 16:16 3-XLSX-UTIL_hyperlinks.xsl.xml
-rw-r--r-- 1 ari ari 4,8M mar  5 16:16 4-XLSX-UTIL_cleanup.xsl.xml
-rw-r--r-- 1 ari ari 4,9M mar  5 16:16 5-XLSX2XML_structure.xsl.xml
-rw-r--r-- 1 ari ari 6,2M mar  5 16:16 6-XLSX2XML_courses.xsl.xml
-rw-r--r-- 1 ari ari 5,6M mar  5 16:16 7-XLSX2XML_dates.xsl.xml
-rw-r--r-- 1 ari ari 5,6M mar  5 16:16 8-XLSX2XML_locations.xsl.xml
-rw-r--r-- 1 ari ari 6,0M mar  5 16:16 9-XLSX2XML_fields.xsl.xml
-rw-r--r-- 1 ari ari 5,7M mar  5 16:16 10-EXC2XI_course.xsl.xml
-rw-r--r-- 1 ari ari 5,7M mar  5 16:16 11-EXC2XI_content-fields.xsl.xml
-rw-r--r-- 1 ari ari 5,7M mar  5 16:16 12-EXC2XI_course-links.xsl.xml
-rw-r--r-- 1 ari ari 5,5M mar  5 16:16 13-EXC2XI_categories.xsl.xml
-rw-r--r-- 1 ari ari 5,5M mar  5 16:16 14-EXC2XI_exc-locations.xsl.xml
-rw-r--r-- 1 ari ari 5,6M mar  5 16:16 15-EXC2XI_exc-events.xsl.xml
-rw-r--r-- 1 ari ari 5,3M mar  5 16:16 16-EXC2XI_exc-duration.xsl.xml
-rw-r--r-- 1 ari ari 5,3M mar  5 16:16 17-EXC2XI_exc-email.xsl.xml
-rw-r--r-- 1 ari ari 4,4M mar  5 16:16 18-EXC2XI_xi-dedupe.xsl.xml
-rw-r--r-- 1 ari ari 4,4M mar  5 16:16 19-EXC2XI_xi-cleanup.xsl.xml</code>
						</pre>
						
						<aside class="notes">
							<ul>
								<li>Output from each step saved</li>
								<li>Output named after step</li>
								<li>Step 0 is a copy of the original</li>
								<li>Note the size of debug files</li>
							</ul>
						</aside>
					</section>
					
					<section>
						<!-- Pipeline organisation and grouping -->
						
						<p>Pipeline grouping</p>
						
						<pre class="stretch">
                            <code class="xml" data-trim data-noescape>
&lt;manifest xml:base=".">
	
  &lt;group xml:base="../xslt/common/">
    &lt;item href="word-to-xhtml5-elements.xsl" description="Flat Word to XHTML conversion"/>
    &lt;item href="add-eqn-pi.xsl" description="inserts a PI placeholder for equations"/>
    ...
  &lt;/group>

  ...
	
  &lt;!-- Xref and cite processing -->
  &lt;group xml:base="../xslt/stair-halsbury/">...&lt;/group>
	
  &lt;!-- Kepler cleanup -->
  &lt;group xml:base="../xslt/stair-halsbury/">
    &lt;item href="html2kepler_cleanup.xsl"/>
    &lt;item href="html2kepler_namespacecleanup.xsl"/>
  &lt;/group>
	
&lt;/manifest></code>
						</pre>
					</section>
					
					<section>
						<!-- Attr processing -->
					</section>
					
					<section>
						<!-- Breadcrumb attrs -->
					</section>
					
				</section>
				
				<!-- END of Developing -->
				
				
				
				<!-- START of Testing -->
				
				<section>
					<section>
						<h3>Testing</h3>
						
						<!--<img src="img/heating-463904_1920.jpg" alt="Gauges" height="350"/>-->
						<img src="img/pipes-5146458_1920.jpg" alt="Pipes by a window" height="400"/>
						
						<!-- XSpec link -->
						
						<aside class="notes">
							
						</aside>
					</section>
					
					<section>
						<!-- XSpec manifest -->
						<!-- Excellent for documentation, too! -->
					</section>
					
					<section>
						<!-- Multiple XSpecs per test, other tricks -->
					</section>
					
				</section>
				
				<!-- END of Testing -->
				
				
				
				<!-- START of Documenting -->
				
				<section>
					<section>
						<h3>Documenting</h3>
						
						<img src="img/picture-3492204_1920.jpg" alt="Picture tools" height="350"/>
						
						<aside class="notes">
							
						</aside>
					</section>
					
					<section>
						<!-- @description in manifest -->
					</section>
					
					<section>
						<!-- XSpecs -->
					</section>
					
					<section>
						<!-- Why not combine XSLT and XSpec manifests into a single manifest format? -->
					</section>
					
				</section>
				
				<!-- END of Documenting -->
				
				
				
				<!-- START of Implementing -->
				
				<section>
					<section>
						<h3>Implementing</h3>
						
						<img src="img/lost-places-3683429_1920.jpg" alt="Lost pipes" height="400"/>
						
						<!-- XProc 1.0 implementation, Nic -->
						
						<aside class="notes">
							
						</aside>
					</section>
					
					<section>
						<!-- Nic's basic mechanism -->
					</section>
					
					<section>
						<!-- XQuery 3.1 variant -->
						<!-- Still uses manifest as-is -->
						<!-- Dev in XProc version since it's got most of the goods, XQ for deploy only -->
						<!-- XSpec not supported yet -->
					</section>
					
					<section>
						<!-- XProc 3.0? -->
						<!-- Convert manifest to XProc 3.0 pipeline directly? (Why it wasn't a good idea in 1.0.) -->
						<!-- XProc 3.0 variant implementations? -->
					</section>
					
				</section>
				
				<!-- END of Implementing -->
				
				
				
				<!-- START of End Notes -->
				
				<section>
					<section data-background="img/after-fire.png" data-background-size="100%">
						<h3>Conclusions</h3>
						
						<aside class="notes">
							
						</aside>
					</section>
					
					
					<section>
						
						<img src="img/this-road.jpg" alt="Submerged road sign" style="width: 70%; height: auto">
						
						<!-- Other pipeline languages and my POV -->
						<!-- XSLT 3.0 variant -->
						
						<aside class="notes">
							
						</aside>
					</section>
					
					<section>
						<!-- Why not? -->
						
						<!-- XProc 1.0 takes lots of resources -->
						<!-- Debug can take a lot of space -->
						<!-- Another framework you'll have to support (XProc in addition to XSLT, say) -->
						<!-- Steps not independent from each other? Absolutely true, but they are not meant to be! -->
						
						<!-- Why? -->
						<!-- Focus on one thing only -->
						<!-- Easier to maintain -->
						<!-- Safer -->
						<!-- Fun -->
					</section>
					
					<section>
						<h3>Thank You!</h3>
						<aside class="notes">
							
						</aside>
					</section>
					
				</section>
				
				<!-- END of End Notes -->
				
			</div>
		</div>

		<!--<script src="js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				hash: true,
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/highlight/highlight.js' },
					{ src: 'plugin/notes/notes.js', async: true }
				]
			});
		</script>-->
		
		<script src="dist/reveal.js"></script>
		<script src="plugin/notes/notes.js"></script>
		<script src="plugin/markdown/markdown.js"></script>
		<script src="plugin/highlight/highlight.js"></script>
		<script>
			// More info about initialization & config:
			// - https://revealjs.com/initialization/
			// - https://revealjs.com/config/
			Reveal.initialize({
				hash: true,

				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealMarkdown, RevealHighlight, RevealNotes ]
			});
		</script>
		
	</body>
</html>
